<html>
<head>
<title>Go Websocket Example</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        var conn = null;
        var ctx = null;

        function drawBlock(block) {
            ctx.fillStyle = "rgba("+block.R+","+block.G+","+block.B+", 0."+block.A+")";
            ctx.fillRect (block.X, block.Y, block.W, block.H);
        }

        if (window["WebSocket"]) {
            conn = new WebSocket("ws://{{$}}/ws");
            conn.onclose = function(evt) {
                console.log('Connection Closed');
            }
            conn.onmessage = function(evt) {
                var block = JSON.parse(evt.data).Block;
                drawBlock(block);
            }
        } else {
            $('.no-websockets').removeClass('hidden');
        }

        var canvas = $('#game-board')[0];
        if (canvas.getContext){
            ctx = canvas.getContext('2d');

        } else {
            $('.no-canvas').removeClass('hidden');
        }
    });
</script>

<style type="text/css">
html {
    width: 100%;
    height: 100%;
}

body {
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0;
    background: gray;
}

#game-board {
    width: 100%;
    height: 100%;
    background: white;
}

.hidden {
    display: none;
}

</style>

</head>
<body>
<canvas id="game-board" width="300" height="300">
    <p class="no-canvas hidden">Sorry Canvas is not available on your browser...</p>
</canvas>
<p class="no-websockets hidden">Sorry Your browser doesn't support websockets</p>
</body>
</html>
